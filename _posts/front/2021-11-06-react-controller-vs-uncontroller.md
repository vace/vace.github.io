---
layout: post
title:  React ä¸­å—æ§å’Œéå—æ§çš„è¡¨å•çš„åŒºåˆ«ä»¥åŠåœºæ™¯
categories: [å‰ç«¯]
tags: [javascript,react]
---

React æœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥å¤„ç†è¡¨å•è¾“å…¥ã€‚

å¦‚æœä¸€ä¸ª input è¡¨å•å…ƒç´ çš„å€¼æ˜¯ç”± React æ§åˆ¶ï¼Œå°±å…¶ç§°ä¸ºå—æ§ç»„ä»¶ã€‚å½“ç”¨æˆ·å°†æ•°æ®è¾“å…¥åˆ°å—æ§ç»„ä»¶æ—¶ï¼Œä¼šè§¦å‘ä¿®æ”¹çŠ¶æ€çš„äº‹ä»¶å¤„ç†å™¨ï¼Œè¿™æ—¶ç”±ä½ çš„ä»£ç æ¥å†³å®šæ­¤è¾“å…¥æ˜¯å¦æœ‰æ•ˆï¼ˆå¦‚æœæœ‰æ•ˆå°±ä½¿ç”¨æ›´æ–°åçš„å€¼é‡æ–°æ¸²æŸ“ï¼‰ã€‚å¦‚æœä¸é‡æ–°æ¸²æŸ“ï¼Œåˆ™è¡¨å•å…ƒç´ å°†ä¿æŒä¸å˜ã€‚

ä¸€ä¸ªéå—æ§ç»„ä»¶ï¼Œå°±åƒæ˜¯è¿è¡Œåœ¨ React ä½“ç³»ä¹‹å¤–çš„è¡¨å•å…ƒç´ ã€‚å½“ç”¨æˆ·å°†æ•°æ®è¾“å…¥åˆ°è¡¨å•å­—æ®µï¼ˆä¾‹å¦‚ inputï¼Œdropdown ç­‰ï¼‰æ—¶ï¼ŒReact ä¸éœ€è¦åšä»»ä½•äº‹æƒ…å°±å¯ä»¥æ˜ å°„æ›´æ–°åçš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œä½ æ— æ³•å¼ºåˆ¶ç»™è¿™ä¸ªè¡¨å•å­—æ®µè®¾ç½®ä¸€ä¸ªç‰¹å®šå€¼ã€‚

åœ¨å¾ˆå¤šæ–‡ç« ä¸­è¯´ä¸åº”è¯¥ä½¿ç”¨`setState`æˆ–`ref`ï¼Œç”šè‡³æœ‰äº›ç†è®ºè‡ªç›¸çŸ›ç›¾ï¼Œå¾ˆéš¾ç†è§£å¦‚ä½•æ­£ç¡®çš„å¤„ç†reactä¸­çš„è¡¨å•ï¼Œç”šè‡³æ²¡æœ‰ç›¸å¯¹ç»Ÿä¸€çš„æ ‡å‡†ã€‚

åˆ°åº•åº”è¯¥æ€ä¹ˆåšè¡¨å•å‘¢ï¼Ÿæ¯•ç«Ÿè¡¨å•æ˜¯è®¸å¤šwebåº”ç”¨ç¨‹åº¦çš„æ ¸å¿ƒï¼Œç„¶è€Œåœ¨`react`ä¸­å¤„ç†è¡¨å•ï¼Œæ€»æœ‰äº›ä¸èˆ’æœï¼Œæ¯”å¦‚å—æ§æ¨¡å¼ï¼ˆ`controlled`ï¼‰å’Œéå—æ§æ¨¡å¼ï¼ˆ`uncontrolled`ï¼‰çš„ä½¿ç”¨åœºæ™¯åŒºåˆ«ã€‚

#### éå—æ§æ¨¡å¼ï¼ˆuncontrolledï¼‰

ä¸å—æ§è¾“å…¥å’Œä¼ ç»Ÿçš„HTMLè¡¨å•å·®ä¸å¤šï¼Œåœ¨æäº¤æˆ–è€…ä½¿ç”¨æ—¶å†å»è¯»å–ä»–çš„å€¼ï¼Œä¾‹å¦‚ï¼š

```jsx
class Form extends Component {
  constructor (props) {
    super(props)
    this.input = React.createRef()
  }
  onSubmitClick: () => {
    alert(this.input.current.value)
  }

  render () {
    return (
      <div>
        <input type="text" ref={this.input} />
        <button onClick={this.onSubmitClick}>ç™»é™†ç”¨æˆ·</button>
      </div>
    )
  }
}

```

æ¢å¥è¯è¯´ï¼Œå¿…é¡»åœ¨éœ€è¦çš„æ—¶å€™ï¼Œä»domä¸­è¯»å–å‡ºå­—æ®µå€¼ï¼Œæ¯”å¦‚æäº¤è¡¨å•çš„æ—¶å€™ï¼Œè¿™æ˜¯å®ç°è¡¨å•è¾“å…¥çš„æœ€ç®€å•æ–¹æ³•ï¼Œä¸è¿‡è¿™ä¸ªåŠŸèƒ½ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­å¯èƒ½ä¸å¤ªåˆé€‚ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å—æ§æ¨¡å¼ä¸‹çš„è¡¨å•ã€‚

**æ³¨æ„ï¼šåœ¨éå—æ§ç»„ä»¶ä¸­ï¼Œç»å¸¸æœŸæœ›èµ‹äºˆç»„ä»¶ä¸€ä¸ªåˆå§‹å€¼ï¼Œä½†æ˜¯åç»­ä¸å»æ›´æ–°ï¼Œè¿™ç§æƒ…å†µä¸‹å¯æŒ‡å®šä¸€ä¸ª`defaultValue`ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶å·²ç»æŒ‚è½½ä¹‹åï¼Œæ˜¯æ›´æ–°defaultValueçš„å€¼ï¼Œä¸ä¼šé€ æˆdomä¸Šçš„ä»»ä½•æ›´æ–°**

```jsx
function AppRender () {
  const input = React.createRef()
  const onHandleSubmit = () => {
    alert(input.current.value)
  }
  return (
    <form onSubmit={onHandleSubmit}>
      <label>
        Name:
        <input
          defaultValue="Bob"
          type="text"
          ref={input} />
      </label>
      <input type="submit" value="Submit" />
    </form>
  )
}
```

| å…ƒç´ 	| é»˜è®¤å€¼ |
| :--  | :---:  |
| `<input type="checkbox">` | `defaultChecked` |
| `<input type="radio">` | `defaultChecked` |
| `<input>` | `defaultValue` |
| `<textarea>` | `defaultValue` |
| `<select>` | `defaultValue` |

#### å—æ§æ¨¡å¼ï¼ˆcontrolledï¼‰

ä¸€ä¸ªå—æ§è¾“å…¥ç»„ä»¶ä¼šæ¥æ”¶å½“å‰çš„å€¼ä½œä¸º`prop`ï¼Œä½¿ç”¨å›è°ƒå‡½æ•°æ”¹å˜è¿™ä¸ªå€¼ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ç§æ›´`react`çš„æ–¹å¼ã€‚

```jsx
<input value={someValue} onChange={onHandleChange}>
```

é€šå¸¸è¡¨å•è¾“å…¥çš„å€¼ä¼šä¿å­˜åœ¨å½“å‰ç»„ä»¶çš„`state`ä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨å¦å¤–çš„ç»„ä»¶`state`ä¸Šï¼Œç”šè‡³æ˜¯`redux`ä¹‹ç±»çš„å•ç‹¬çŠ¶æ€å­˜å‚¨å™¨ä¸­ã€‚

```jsx
class Form extends Components {
  constructor (props) {
    super(props)
    this.state = {
      name: ''
    }
  }

  onHandleName (e) {
    this.setState({ name: event.target.value  })
  }

  render () {
    return (
      <div>
        <input
          type="text"
          value={this.state.name}
          onChange={this.onHandleName}
        />
      </div>
    )
  }
}
```

ğŸ‘†ğŸ»ä¸Šé¢çš„æ¡ˆä¾‹ä¸­æ¯æ¬¡è¾“å…¥æ–°çš„å­—ç¬¦æ˜¯ï¼Œéƒ½ä¼šå®æ—¶é€šè¿‡`onChange`æ›´æ–°`state`ï¼Œ

- ä»ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å¼€å§‹ - `state = {name: ''}`
- è¾“å…¥aæ—¶ï¼Œ`value="a"` - `setState({ name: 'a' })`
- è¾“å…¥bæ—¶ï¼Œ`value="ab"` - `setState({ name: 'ab' })`

è¿™ç§æµç¨‹ä¼šå°†è¡¨å•å€¼çš„å˜æ›´æ¨é€åˆ°`Form`ç»„ä»¶ï¼Œæ‰€ä»¥`Form`ç»„ä»¶å§‹ç»ˆå…·æœ‰å½“å‰è¾“å…¥çš„å€¼ï¼Œè¿™æ„å‘³ç€æ•°æ®`state`å’ŒUI`input`å§‹ç»ˆä¿æŒåŒæ­¥ï¼ŒçŠ¶æ€ä¸ºè¾“å…¥æä¾›å€¼ï¼Œè¾“å…¥è¦æ±‚`Form`æ›´æ”¹å½“å‰å€¼ï¼Œè¿™æ„å‘³ç€è¡¨å•ç»„ä»¶å¯ä»¥ç«‹å³å“åº”æ›´æ”¹æ•°æ®ï¼Œä¾‹å¦‚ï¼š

- åé¦ˆè¡¨å•çŠ¶æ€ï¼Œå¦‚è¾“å…¥éªŒè¯
- UIçŠ¶æ€ä¸è¾“å…¥ç›¸å…³ï¼Œå¦‚æœªå¡«å†™å¿…å¡«å­—æ®µæ—¶ï¼Œç¦ç”¨æŒ‰é’®
- å¼ºåˆ¶è¾“å…¥ç‰¹å®šæ ¼å¼æ•°æ®ï¼Œå¦‚æ‰‹æœºå·ã€ä¿¡ç”¨å¡å·çš„è¾“å…¥

å¦‚æœåº”ç”¨ä¸­ä¸éœ€è¦è¿™äº›ï¼Œé‚£ä¹ˆä½¿ç”¨å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶åŒºåˆ«ä¸å¤§ã€‚

#### å¦‚ä½•ä½¿å…ƒç´ å—æ§ï¼Ÿ

é™¤äº†åŸºç¡€çš„`input`å…ƒç´ ï¼Œè¡¨å•è¿˜åŒ…å«å…¶ä»–çš„å„ç±»å…ƒç´ ï¼Œå¦‚`select`å’Œ`textarea`ï¼Œå¦‚æœé€šè¿‡`prop`è®¾ç½®è¡¨å•å…ƒç´ çš„å€¼ï¼Œåˆ™è¡¨å•å°†è¢«æ§åˆ¶ï¼Œä¸ºå—æ§ç»„ä»¶ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚

ä½†æ˜¯ä¸åŒçš„è¡¨å•å…ƒç´ éƒ½æœ‰ä¸åŒçš„å±æ€§æ¥è®¾ç½®è¯¥å€¼ï¼š


| å…ƒç´ 	| value	| æ›´æ”¹å›è°ƒ	| å›è°ƒä¸­çš„æ–°å€¼ |
| :--  | :-----:| :----:  | :----:  |
|`<input type="text" />` |	`value="string"`	| `onChange` |	`event.target.value` |
|`<input type="checkbox" />` |	`checked={boolean}`	| `onChange` |	`event.target.checked` |
|`<input type="radio" />` |	`checked={boolean}`	| `onChange` |	`event.target.checked` |
|`<textarea />` |	`value="string"`	| `onChange` |	`event.target.value` |
|`<select />` |	`value="option value"`	| `onChange` |	`event.target.value` |

#### æ–‡ä»¶è¾“å…¥`File`

åœ¨ HTML ä¸­ï¼Œ`<input type="file">` å¯ä»¥è®©ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨ File API è¿›è¡Œæ“ä½œã€‚

```html
<input type="file" />
```

åœ¨ React ä¸­ï¼Œ`<input type="file" />` å§‹ç»ˆæ˜¯ä¸€ä¸ªéå—æ§ç»„ä»¶ï¼Œå› ä¸ºå®ƒçš„å€¼åªèƒ½ç”±ç”¨æˆ·è®¾ç½®ï¼Œè€Œä¸èƒ½é€šè¿‡ä»£ç æ§åˆ¶ã€‚


#### æ€»ç»“

å—æ§ç»„ä»¶å’Œéå—æ§è¡¨å•ç»„ä»¶éƒ½å…·æœ‰æœ‰ç‚¹ï¼Œåº”è¯¥æ ¹æ®å…·ä½“åœºæ™¯è¿›è¡Œé€‰æ‹©ï¼Œå¦‚æœUIåé¦ˆéå¸¸ç®€å•ï¼Œåˆ™æ— éœ€å…³æ³¨è¿™äº›é—®é¢˜

| ç‰¹å¾ | ä¸å—æ§åˆ¶çš„ | å—æ§ |
| :--: |:--: |:--: |
| ä¸€æ¬¡æ€§å€¼ï¼ˆå¦‚æäº¤æ—¶ï¼‰ | âœ… |	âœ… |
| æäº¤æ—¶éªŒè¯ | âœ… |	âœ… |
| å®æ—¶æ•°æ®éªŒè¯ | âŒ |	âœ… |
| æœ‰æ¡ä»¶åœ°ç¦ç”¨æäº¤æŒ‰é’® | âŒ |	âœ… |
| å¼ºåˆ¶è¾“å…¥æ ¼å¼ | âŒ |	âœ… |
| ä¸€ä¸ªæ•°æ®çš„å¤šä¸ªè¾“å…¥ | âŒ |	âœ… |
| åŠ¨æ€è¾“å…¥ | âŒ |	âœ… |


#### æ€»ç»“

[å®˜æ–¹ React æ–‡æ¡£ä¸Šçš„è¡¨å•é¡µé¢](https://zh-hans.reactjs.org/docs/forms.html)
[å®˜æ–¹ React æ–‡æ¡£ä¸Šçš„æ”¯æŒäº‹ä»¶](https://zh-hans.reactjs.org/docs/events.html)
[Controlled and uncontrolled form inputs in React don't have to be complicated](https://goshacmd.com/controlled-vs-uncontrolled-inputs-react/)

